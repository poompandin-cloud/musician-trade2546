# à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸à¸£à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™

## âœ… à¸ªà¸–à¸²à¸™à¸°à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¹à¸¥à¹‰à¸§

### 1. à¹€à¸žà¸´à¹ˆà¸¡à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ is_calendar_entry
- âœ… à¸ªà¸£à¹‰à¸²à¸‡ migration: `supabase_migrations/add_is_calendar_entry_column.sql`
- âœ… à¹€à¸žà¸´à¹ˆà¸¡à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ: `is_calendar_entry BOOLEAN DEFAULT FALSE`
- âœ… à¸ªà¸£à¹‰à¸²à¸‡ index: `idx_jobs_is_calendar_entry`

### 2. à¸­à¸±à¸›à¹€à¸”à¸• Logic à¸à¸²à¸£à¸à¸£à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥

#### âœ… Calendar (fetchCalendarJobs) - à¸›à¸à¸´à¸—à¸´à¸™
```tsx
const { data, error } = await supabase
  .from('jobs')
  .select('*')
  .eq('user_id', profileUserId)
  .eq('is_calendar_entry', true) // âœ… à¸”à¸¶à¸‡à¹€à¸‰à¸žà¸²à¸° calendar entries
  .order('date', { ascending: true });
```

#### âœ… My Jobs (fetchMyJobs) - à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸‰à¸±à¸™à¸›à¸£à¸°à¸à¸²à¸¨
```tsx
const { data, error } = await (supabase as any)
  .from("jobs")
  .select("*")
  .eq("user_id", profileUserId)
  .eq("is_calendar_entry", false) // âœ… à¸”à¸¶à¸‡à¹€à¸‰à¸žà¸²à¸°à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
  .order("created_at", { ascending: false });
```

#### âœ… Nearby Gigs (App.tsx activeJobs) - à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸›à¸£à¸°à¸à¸²à¸¨
```tsx
const activeJobs = jobs.filter(job => {
  const isRecent = (Date.now() - jobTime) < (3 * 24 * 60 * 60 * 1000);
  const isNotCalendarEntry = !job.is_calendar_entry; // âœ… à¸à¸£à¸­à¸‡à¸­à¸­à¸ calendar entries
  return isRecent && isNotCalendarEntry;
});
```

### 3. à¸­à¸±à¸›à¹€à¸”à¸• Logic à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥

#### âœ… Save Calendar Entry (handleSaveJob)
```tsx
const jobData = {
  user_id: profileUserId,
  instrument: job.title,
  start_time: job.start_time,
  end_time: endTime,
  date: job.date,
  is_calendar_entry: true, // âœ… à¸£à¸°à¸šà¸¸à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™ calendar entry
};
```

#### âœ… Sync Data
```tsx
// à¸«à¸¥à¸±à¸‡à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸³à¹€à¸£à¹‡à¸ˆ
await fetchCalendarJobs(); // à¸­à¸±à¸›à¹€à¸”à¸•à¸›à¸à¸´à¸—à¸´à¸™
await fetchMyJobs();    // à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
```

#### âœ… Delete Calendar Entry (handleDeleteCalendarJob)
```tsx
// à¸«à¸¥à¸±à¸‡à¸¥à¸šà¸ªà¸³à¹€à¸£à¹‡à¸ˆ
await fetchMyJobs(); // à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
```

## ðŸ“‹ à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š

### 1. à¸à¸²à¸£à¹€à¸žà¸´à¹ˆà¸¡à¸‡à¸²à¸™à¸›à¸à¸´à¸—à¸´à¸™
```
Modal â†’ handleSaveJob â†’ upsert to jobs (is_calendar_entry: true)
                    â†’ fetchCalendarJobs() â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¸›à¸à¸´à¸—à¸´à¸™
                    â†’ fetchMyJobs() â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
```

### 2. à¸à¸²à¸£à¸¥à¸šà¸‡à¸²à¸™à¸›à¸à¸´à¸—à¸´à¸™
```
Modal â†’ handleDeleteCalendarJob â†’ delete from jobs
                          â†’ fetchMyJobs() â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
```

### 3. à¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸œà¸¥
- **à¸›à¸à¸´à¸—à¸´à¸™**: `WHERE is_calendar_entry = true`
- **à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸‰à¸±à¸™à¸›à¸£à¸°à¸à¸²à¸¨**: `WHERE is_calendar_entry = false`
- **Nearby Gigs**: `WHERE is_calendar_entry = false` + time filter

## ðŸŽ¯ à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸—à¸µà¹ˆà¸„à¸²à¸”à¸«à¸§à¸±à¸‡

### âœ… 1. à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸£à¸±à¹ˆà¸§à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
- à¸›à¸à¸´à¸—à¸´à¸™à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° calendar entries
- à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° job postings
- à¸«à¸™à¹‰à¸² Nearby Gigs à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° job postings

### âœ… 2. à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‹à¸´à¸‡à¸„à¹Œà¸à¸±à¸™
- à¸šà¸±à¸™à¸—à¸¶à¸à¸›à¸à¸´à¸—à¸´à¸™ â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨à¸—à¸±à¸™à¸—à¸µ
- à¸¥à¸šà¸›à¸à¸´à¸—à¸´à¸™ â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨à¸—à¸±à¸™à¸—à¸µ
- à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸ªà¸±à¸šà¸ªà¸™à¸à¸¥à¸±à¸šà¸à¸±à¸™

### âœ… 3. à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸ž
- à¹ƒà¸Šà¹‰à¸•à¸²à¸£à¸²à¸‡à¹€à¸”à¸µà¸¢à¸§ (jobs)
- à¸à¸£à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸”à¹‰à¸§à¸¢ flag (is_calendar_entry)
- à¸¡à¸µ index à¸ªà¸³à¸«à¸£à¸±à¸šà¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸ž

## ðŸš€ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š

### 1. à¸£à¸±à¸™ Migration
```sql
-- à¹ƒà¸™ Supabase SQL Editor
-- à¸£à¸±à¸™à¹„à¸Ÿà¸¥à¹Œ: supabase_migrations/add_is_calendar_entry_column.sql
```

### 2. à¸—à¸”à¸ªà¸­à¸š Logic
```sql
-- à¹ƒà¸™ Supabase SQL Editor
-- à¸£à¸±à¸™à¹„à¸Ÿà¸¥à¹Œ: test_filtering_logic.sql
-- à¹à¸—à¸™à¸—à¸µà¹ˆ YOUR_USER_ID_HERE à¸”à¹‰à¸§à¸¢ user ID à¸ˆà¸£à¸´à¸‡
```

### 3. à¸—à¸”à¸ªà¸­à¸šà¹ƒà¸™à¹à¸­à¸›
- à¹€à¸žà¸´à¹ˆà¸¡à¸‡à¸²à¸™à¹ƒà¸™à¸›à¸à¸´à¸—à¸´à¸™ â†’ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸¡à¹ˆà¸›à¸£à¸²à¸à¸à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
- à¸¥à¸šà¸‡à¸²à¸™à¹ƒà¸™à¸›à¸à¸´à¸—à¸´à¸™ â†’ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸«à¸²à¸¢à¹„à¸›à¸ˆà¸²à¸à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸«à¸™à¹‰à¸²à¸›à¸à¸´à¸—à¸´à¸™à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° calendar entries

## ðŸ“± à¸ªà¸–à¸²à¸™à¸°à¸—à¸µà¹ˆà¸„à¸§à¸£à¹€à¸›à¹‡à¸™

### âœ… 1. à¸à¸²à¸£à¸à¸£à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
- Calendar: `is_calendar_entry = true`
- My Jobs: `is_calendar_entry = false`
- Nearby Gigs: `is_calendar_entry = false`

### âœ… 2. à¸à¸²à¸£à¸‹à¸´à¸‡à¸„à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
- à¸šà¸±à¸™à¸—à¸¶à¸/à¸¥à¸šà¸›à¸à¸´à¸—à¸´à¸™ â†’ à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨à¸—à¸±à¸™à¸—à¸µ
- à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¸à¸´à¸—à¸´à¸™à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨
- à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨à¹ƒà¸™à¸«à¸™à¹‰à¸²à¸›à¸à¸´à¸—à¸´à¸™

### âœ… 3. à¸à¸²à¸£à¹à¸ªà¸”à¸‡à¸œà¸¥
- à¸›à¸à¸´à¸—à¸´à¸™: à¹à¸ªà¸”à¸‡à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡ (calendar entries)
- à¸‡à¸²à¸™à¸›à¸£à¸°à¸à¸²à¸¨: à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° job postings
- à¹à¸¢à¸à¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ: à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸ªà¸±à¸šà¸ªà¸™à¸à¸¥à¸±à¸šà¸à¸±à¸™
